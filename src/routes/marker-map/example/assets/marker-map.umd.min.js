!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):(t=t||self).MarkerMap=e()}(this,(function(){"use strict";return function(){let t=null,e=1,a=null,i=null,r=[];const n={id:e,active:!0,width:null,top:null,left:null,img:null,meta:{}},s={background:null,markers:[],inactiveOpacity:.6};this.render=(l="body",m=s)=>{if(o(m),t=document.querySelector(l),a=t.getElementsByClassName("marker-map-marker"),i=t.querySelector("#marker-map-markers"),!m.background)throw"background is not set";e=1,r=m.markers.map((t=>(d(t),e++,{...n,...t})));const u=`<img id="marker-map-bg" src="${m.background}" width="100%" height="100%" />`;t.innerHTML=`<div id="marker-map"style="width:100%;height:100%;position:relative;margin:0 auto;">${u}<div id="marker-map-markers">${r.map((t=>c(t))).join("")}</div></div>`};const c=(t=n)=>`<img class="marker-map-marker ${!1===t.active?"inactive":""}" data-marker-img="${t.img}" data-marker-id="${t.id}"\n    style="width:${t.width}%;top:${t.top}%;left:${t.left}%;" src="${t.img}" />`,d=(t=n)=>{if(!(t.img&&t.top&&t.left&&t.width))throw"some marker data not correct"},l=(t=null)=>(this.get(t),document.querySelector(`[data-marker-id="${t}"]`));this.add=(t=n)=>{d(t),e++;const a={...n,...t};r.push(a),document.getElementById("marker-map-markers").insertAdjacentHTML("beforeEnd",c(t))},this.remove=t=>{r.filter((e=>e.id!==t)),l(t).remove()},this.removeAll=()=>{r=[],i.innerHTML=""},this.active=(t=null)=>{l(t).classList.remove("inactive")},this.activeAll=()=>{[...a].forEach((t=>{t.classList.remove("inactive")}))},this.inactive=(t=null)=>{l(t).classList.add("inactive")},this.inactiveAll=()=>{[...a].forEach((t=>{t.classList.add("inactive")}))};const o=(t=s)=>{const e=`.marker-map-marker{position:absolute;} .marker-map-marker.inactive{opacity:${{...s,options:t}.inactiveOpacity};}`,a=document.createElement("style");a.textContent=e,document.head.append(a)};this.on=(e,a)=>{t.addEventListener(e,(t=>{t.target.dataset.markerId&&a(t,this.get(t.target.dataset.markerId))}))},this.get=(t=null)=>{const e=r.find((e=>e.id==t));if(!e)throw"can not find marker";return e},this.getAll=(t="",e)=>{const i=[...a].filter((e=>{switch(t){case"active":return!e.classList.contains("inactive");case"inactive":return e.classList.contains("inactive");default:return!0}})),n=i.map((t=>({id:t.dataset.markerId,width:parseInt(t.style.width),top:parseInt(t.style.top),left:parseInt(t.style.left),img:t.dataset.markerImg,active:!t.classList.contains("inactive"),meta:r.find((e=>e.id==t.dataset.markerId)).meta||{}})));switch(e){case"json":return n;case"dom":return i;default:return n}},this.destroy=()=>{t.innerHTML="",t=null,e=1,a=null,i=null,r=[],e=1}}}));
